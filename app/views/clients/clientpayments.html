<div class="col-md-12" ng-controller="ClientPaymentsController">
	<div>
		<ul class="breadcrumb">
			<li>{{client.officeName}}</li>
			<li>{{client.staffName}}</li>
		</ul>
	</div>
	<div class="row">
		<div class="col-md-8 col-sm-8">
			<h3 class="client-title">
				{{'label.heading.clientpayments' | translate}}
				<i class="icon-circle {{client.status.code | StatusLookup}}"></i>
				<small ng-if="client.subStatus.description">
					[{{client.subStatus.description}}]
				</small>
				<strong>{{client.displayName}} </strong>
				<small>
					{{ 'label.heading.clientno' | translate }}: {{client.accountNo}} |
					{{ 'label.input.externalid' | translate }}: {{client.externalId}} |
					{{ 'label.input.staff' | translate }}: {{client.staffName}}
				</small>
			</h3>
		</div>
	</div>

	<div class="col-md-12 col-sm-12">
		<div class="row client">
			<div class="col-sm-12 col-md-12 paddingleft0px">
				<div data-ng-show="loanAccounts || savingsAccounts">
					<form name="clientpayments" class="form-horizontal well">
						<api-validate></api-validate>
						<div>
							<table class="table table-condensed">
								<tr class="graybg" data-ng-show="loanAccounts">
									<th>{{'label.heading.loans' | translate}}</th>
									<th>{{'label.heading.accnum' | translate}}</th>
									<th>{{'label.heading.loanaccount' | translate}}</th>
									<th>{{'label.heading.loanamount' | translate}}</th>
									<th>{{'label.heading.outstandingamount' | translate}}</th>
									<th>{{'label.heading.dueamount' | translate}}</th>
									<th>{{'label.heading.type' | translate}}</th>
									<th>{{'label.heading.loans.repayments' | translate}}</th>
									<th>{{'label.heading.Loancharges' |translate}}</th>
									<th>{{'label.heading.addcharges'|translate}}</th>
								</tr>


								<tr ng-repeat="loanaccount in loanAccounts | orderBy:'id':true | filter:isLoanNotClosed">
									<td><input id="actualDisbursementDate" type="hidden" name="actualDisbursementDate" ng-model="loanaccount.timeline.actualDisbursementDate"/></td>

									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)">
										<i ng-hide="loanaccount.inArrears" tooltip-placement="right" tooltip-placementoltip="{{loanaccount.status.value}}"
										   class="icon-stop {{loanaccount.status.code | StatusLookup}}"></i>
										<i ng-show="loanaccount.inArrears" tooltip-placement="right" tooltip="{{loanaccount.status.value}}"
										   class="icon-stop {{loanaccount.status.code | StatusLookup}}overdue"></i>
										{{loanaccount.accountNo}}
									</td>
									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)">{{loanaccount.productName}}</td>
									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)">{{loanaccount.originalLoan|number}}</td>
									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)">{{loanaccount.loanBalance|number}}</td>
									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)">{{loanaccount.amountPaid|number}}</td>
									<td class="pointer center" data-ng-click="routeToLoan(loanaccount.id)" ng-if="loanaccount.loanType.value == 'Individual'">
										<i tooltip="{{loanaccount.loanType.value}}" class="icon-user icon-large"></i>
									</td>
									<td class="pointer center" data-ng-click="routeToLoan(loanaccount.id)" ng-if="loanaccount.loanType.value != 'Individual'">
										<i tooltip="{{loanaccount.loanType.value}}" class="icon-group icon-large"></i>
									</td>
									<td ng-if="loanaccount.status.active" align="right">
										<input class="col-sm-8" id="repaymentAmount" type="text" name="repaymentAmount"
											   ng-model="loanaccount.repaymentAmount" ng-keyup="keyPress()" class="form-control" number-format />
										<input id="loanactiveCheckbox" ng-change="keyPress()" ng-model="loanaccount.active"
												ng-init="loanaccount.active=true" ng-checked="true" type="checkbox"/></td>
									<td class="pointer" data-ng-click="routeToLoan(loanaccount.id)"> &nbsp;&nbsp;&nbsp;&nbsp;{{formData.charges}}
									<i class="icon-question-sign" tooltip={{formData.chargeDescription}} tooltip-append-to-body="true"></i></td>
									<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a ng-click="showAddLoanCharges(loanaccount.id)">&nbsp;<i class="icon-plus icon-blue"></i></a>
                                    </td>
									</tr>



									<!--
									for addings savings charges
									-->







									<div ng-show="addLoanCharges==true">

										<form class="form-horizontal well" novalidate="" name="loanchargeform" ng-submit="submit1()">
											<api-validate></api-validate>
											<fieldset>
												<legend>{{ 'label.heading.addloancharge' | translate }}</legend>

												<div class="form-group">
													<label class="control-label col-sm-2" for="chargeId">{{ 'label.input.charge' | translate }}<span
															class="required">*</span></label>

													<div class="col-sm-3">
														<select id="chargeId" ng-model="formData.chargeId" class="form-control"
																ng-options="charge.id as (charge.name+' '+'('+charge.currency.name+')') for charge in charges"
																value="{{charge.id}}" ng-change="selectCharge()">
															<option value="">{{'label.selectcharge' | translate}}</option>
														</select>
													</div>
												</div>
												<div ng-hide="isCollapsed">
													<div class="form-group">
														<label class="control-label col-sm-2" for="amount">{{ 'label.input.amount' | translate }}<span
																class="required">*</span></label>

														<div class="col-sm-3">
															<input id="amount" type="text" class="form-control" name="amount" ng-model="formData.amount" required
																   number-format ng-late-Validate>
														</div>
														<div class="col-sm-3">
						                         <span ng-show="loanchargeform.amount.$invalid">
                                                            <small class="error">
																{{ 'label.requiredfield' | translate }}
															</small>
                                                  </span>
														</div>
													</div>
													<div class="form-group">
														<label class="control-label col-sm-2">{{ 'label.input.chargecalculation' | translate }}</label>

														<div class="col-sm-3">
															<input type="text" class="form-control" value="{{chargeData.chargeCalculationType.value}}" readonly>
														</div>
													</div>
													<div class="form-group">
														<label class="control-label col-sm-2">{{ 'label.input.chargetime' | translate }}</label>

														<div class="col-sm-3">
															<input type="text" class="form-control" value="{{chargeData.chargeTimeType.value}}" readonly>
														</div>
													</div>
													<div class="form-group" ng-show="chargeData.chargeTimeType.id==2">
														<label class="control-label col-sm-2">{{ 'label.input.dueon' | translate }}<span
																class="required">*</span></label>

														<div class="col-sm-3">
															<input id="dueDate" type="text" datepicker-pop="dd MMMM yyyy" class="form-control"
																   placeholder="{{'label.input.duedate' | translate}}" ng-model="formData.dueDate"
																   is-open="opened" min="minDate" max="'2020-06-22'"/>
														</div>
													</div>
												</div>
											</fieldset>
											<div class="col-md-offset-3">
												<button id="cancel1" type="reset" class="btn btn-default" ng-click="cancel()">{{ 'label.button.cancel' | translate }}
												</button>
												<button id="save1" type="submit" class="btn btn-primary" ng-click="submitLoanCharge()" has-permission='CREATE_LOANCHARGE' ng-show="!isCollapsed">{{ 'label.button.save' |
													translate }}
												</button>
											</div>
										</form>

									</div>








								<tr class="graybg" data-ng-show="savingsAccounts">
									<th>{{'label.heading.deposits' | translate}}</th>
									<th>{{'label.heading.accnum' | translate}}</th>
									<th>{{'label.heading.savingaccount' | translate}}</th>
									<th></th>
									<th class="center">{{'label.heading.balance' | translate}}</th>
									<th></th>
									<th></th>
									<th>{{'label.heading.savings.deposits' | translate}}</th>
									<th>{{'label.heading.Savingcharges'|translate}}</th>
									<th>{{'label.heading.addsavingcharges'|translate}}</th>
								</tr>
								<tr ng-repeat="savingaccount in savingsAccounts | orderBy:'id':true | filter:isSavingNotClosed">
									<td><input id="activatedOnDate" type="hidden" name="activatedOnDate" ng-model="savingaccount.timeline.activatedOnDate"/></td>
									<td class="pointer" data-ng-click="routeToSaving(savingaccount.id, savingaccount.depositType.code)">
										<i tooltip-placement="right" tooltip="{{savingaccount.status.value}}" class="icon-stop {{savingaccount.status.code | StatusLookup}}"></i>
										{{savingaccount.accountNo}}
									</td>
									<td class="pointer" data-ng-click="routeToSaving(savingaccount.id, savingaccount.depositType.code)">{{savingaccount.productName}}</td>
									<td></td>
									<td class="pointer center" data-ng-click="routeToSaving(savingaccount.id, savingaccount.depositType.code)">{{savingaccount.accountBalance|number}}</td>
									<td></td>
									<td></td>
									<td ng-if="savingaccount.status.active"  align="right">
										<input class="col-sm-8" id="depositAmount" type="text" name="depositAmount"
											   ng-model="savingaccount.depositAmount" ng-keyup="keyPress()" class="form-control" number-format />
										<input ng-hide="true" id="savingactiveCheckbox" ng-change="keyPress()" ng-model="savingaccount.active"
											   ng-init="savingaccount.active=true" ng-checked="true" type="checkbox" />
									</td>
									<td class="pointer" data-ng-click="routeToLoan(savingaccount.id)"> &nbsp;&nbsp;&nbsp;&nbsp;{{formData.savingAccountCharges}}
										<i class="icon-question-sign" tooltip={{formData.savingChargesDescription}} tooltip-append-to-body="true"></i></td>
									<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a ng-click="showAddSavingsCharges(savingaccount.id)">&nbsp;<i class="icon-plus icon-blue"></i></a>
									</td>
								</tr>
								<tr class="graybg">
									<th colspan="7">{{'label.clientpayments.totalAmount' | translate}}</th>
									<th><input class="col-sm-8" id="totalAmount" type="text" ng-disabled="true" name="totalAmount"
											   ng-model="formData.totalAmount" class="form-control" number-format /></th>
									<th></th>
									<th></th>
								</tr>
							</table>
						</div>


						<div>
							<table class="table table-condensed">
								<tr>
									<td class="col-sm-3">
										<label class="control-label">{{ 'label.input.submittedon' | translate
											}}&nbsp;<span class="required">*</span></label>
									</td>
									<td class="col-sm-3">
										<input id="submittedOnDate" ng-change="onDateChange()" sort type="text" datepicker-pop="dd MMMM yyyy" ng-model="formData.submittedOnDate" is-open="opened" max="restrictDate" class="form-control"/>
									</td>
									<td>&nbsp;</td>
									<td class="col-sm-3">
										<label class="control-label" for="paymentTypeId">{{ 'label.input.paymenttype' | translate}}<span
												class="required">*</span></label>
									</td>
									<td class="col-sm-3">
										<select id="paymentTypeId" ng-model="formData.paymentTypeId"
												ng-options="paymentType.id as paymentType.name for paymentType in paymentTypes"
												value="{{paymentType.id}}" class="form-control">
										</select>
									<td>
								</tr>
								<tr>
									<td class="col-sm-3">
										<label class="control-label" for="receiptNumber">{{ 'label.input.receiptnumber' | translate}}<span
												class="required">*</span></label>
									</td>
									<td class="col-sm-3">
										<input id="receiptNumber" class="form-control" type="text" ng-model="formData.receiptNumber">
									</td>
									<td>&nbsp;</td>
									<td class="col-sm-3">
										<label class="control-label" for="accountNumber">{{ 'label.input.accnum' | translate}}</label>
									</td>
									<td class="col-sm-3">
										<input id="accountNumber" type="text" class="form-control" ng-model="formData.accountNumber">
									</td>
								</tr>
								<tr>
									<td class="col-sm-3">
										<label class="control-label" for="checkNumber">{{ 'label.input.checknumber' | translate}}</label>
									</td>
									<td class="col-sm-3">
										<input id="checkNumber" class="form-control" type="text" ng-model="formData.checkNumber">
									</td>
									<td>&nbsp;</td>
									<td class="col-sm-3">
										<label class="control-label" for="routingCode">{{ 'label.input.routingcode' | translate}}</label>
									</td>
									<td class="col-sm-3">
										<input id="routingCode" class="form-control" type="text" ng-model="formData.routingCode">
									</td>
								</tr>
								<tr>
									<td class="col-sm-3">
										<label class="control-label" for="bankNumber">{{ 'label.input.banknumber' | translate}}<span
												class="required">*</span></label>
									</td>
									<td class="col-sm-3">
										<input id="bankNumber" class="form-control" sort type="text" ng-model="formData.bankNumber" datepicker-pop="dd MMMM yyyy" is-open="opened" max="restrictDate" >
									</td>
									<td>&nbsp;</td>
									<td></td>
									<td></td>
								</tr>
							</table>

							<div class="col-md-offset-5">
								<button id="cancel" type="reset" class="btn btn-default" ng-click="cancel()">{{ 'label.button.cancel' | translate}}</button>
								<button id="save" type="submit" ng-show="isDisabled" class="btn btn-primary" ng-click="submitPayments()">{{ 'label.button.save' | translate}}</button>
								<button id="precipitant" ng-show="isDisabled" type="submit" class="btn btn-primary" ng-click="submitPaymentsAndPrint()">{{ 'label.button.submitandprint' | translate}}</button>
							</div>

							<div>
								<button ng-show="printbtn" ng-click="printReport()" class="btn btn-primary"><i class="icon-print icon-white">{{'label.button.print' |
									translate}}
								</i></button>
								<div id="printreceiptcontent">
									<iframe id="rptLoadingreceiptFrame" ng-src="{{baseURL}}" frameborder="0" width="100%" height="800px"></iframe>
								</div>
							</div>
						</div>

					</form>

				</div>

			</div>

		</div>
		</div>
	</div>

</div>